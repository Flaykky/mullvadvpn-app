<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="1180px" preserveAspectRatio="none" style="width:3520px;height:1180px;background:#FFFFFF;" version="1.1" viewBox="0 0 3520 1180" width="3520px" zoomAndPan="magnify"><defs/><g><rect height="116.2617" style="stroke:#00000000;stroke-width:4.0;fill:none;" width="888" x="1313" y="40"/><text fill="#000000" font-family="sans-serif" font-size="56" font-weight="bold" lengthAdjust="spacing" textLength="344" x="1333" y="119.8555">Execution of</text><text fill="#000000" font-family="monospace" font-size="56" font-weight="bold" lengthAdjust="spacing" textLength="364" x="1693" y="126.9098">set_allow_lan</text><text fill="#000000" font-family="sans-serif" font-size="56" font-weight="bold" lengthAdjust="spacing" textLength="108" x="2073" y="119.8555">RPC</text><line style="stroke:#181818;stroke-width:2.0;stroke-dasharray:5.0,5.0;" x1="352" x2="352" y1="316.5234" y2="1030.5957"/><line style="stroke:#181818;stroke-width:2.0;stroke-dasharray:5.0,5.0;" x1="1054" x2="1054" y1="316.5234" y2="1030.5957"/><line style="stroke:#181818;stroke-width:2.0;stroke-dasharray:5.0,5.0;" x1="1462" x2="1462" y1="316.5234" y2="1030.5957"/><line style="stroke:#181818;stroke-width:2.0;stroke-dasharray:5.0,5.0;" x1="2362" x2="2362" y1="316.5234" y2="1030.5957"/><line style="stroke:#181818;stroke-width:2.0;stroke-dasharray:5.0,5.0;" x1="3110" x2="3110" y1="316.5234" y2="1030.5957"/><rect fill="#E2E2F0" height="132.2617" rx="10" ry="10" style="stroke:#181818;stroke-width:2.0;" width="668" x="20" y="180.2617"/><text fill="#000000" font-family="sans-serif" font-size="56" lengthAdjust="spacing" textLength="612" x="48" y="268.1172">Management interface</text><rect fill="#E2E2F0" height="132.2617" rx="10" ry="10" style="stroke:#181818;stroke-width:2.0;" width="668" x="20" y="1026.5957"/><text fill="#000000" font-family="sans-serif" font-size="56" lengthAdjust="spacing" textLength="612" x="48" y="1114.4512">Management interface</text><rect fill="#E2E2F0" height="132.2617" rx="10" ry="10" style="stroke:#181818;stroke-width:2.0;" width="280" x="914" y="180.2617"/><text fill="#000000" font-family="sans-serif" font-size="56" lengthAdjust="spacing" textLength="224" x="942" y="268.1172">Daemon</text><rect fill="#E2E2F0" height="132.2617" rx="10" ry="10" style="stroke:#181818;stroke-width:2.0;" width="280" x="914" y="1026.5957"/><text fill="#000000" font-family="sans-serif" font-size="56" lengthAdjust="spacing" textLength="224" x="942" y="1114.4512">Daemon</text><rect fill="#E2E2F0" height="132.2617" rx="10" ry="10" style="stroke:#181818;stroke-width:2.0;" width="272" x="1326" y="180.2617"/><text fill="#000000" font-family="sans-serif" font-size="56" lengthAdjust="spacing" textLength="216" x="1354" y="268.1172">Settings</text><rect fill="#E2E2F0" height="132.2617" rx="10" ry="10" style="stroke:#181818;stroke-width:2.0;" width="272" x="1326" y="1026.5957"/><text fill="#000000" font-family="sans-serif" font-size="56" lengthAdjust="spacing" textLength="216" x="1354" y="1114.4512">Settings</text><rect fill="#E2E2F0" height="132.2617" rx="10" ry="10" style="stroke:#181818;stroke-width:2.0;" width="640" x="2042" y="180.2617"/><text fill="#000000" font-family="sans-serif" font-size="56" lengthAdjust="spacing" textLength="584" x="2070" y="268.1172">Tunnel state machine</text><rect fill="#E2E2F0" height="132.2617" rx="10" ry="10" style="stroke:#181818;stroke-width:2.0;" width="640" x="2042" y="1026.5957"/><text fill="#000000" font-family="sans-serif" font-size="56" lengthAdjust="spacing" textLength="584" x="2070" y="1114.4512">Tunnel state machine</text><rect fill="#E2E2F0" height="132.2617" rx="10" ry="10" style="stroke:#181818;stroke-width:2.0;" width="776" x="2722" y="180.2617"/><text fill="#000000" font-family="sans-serif" font-size="56" lengthAdjust="spacing" textLength="720" x="2750" y="268.1172">Daemon event subscribers</text><rect fill="#E2E2F0" height="132.2617" rx="10" ry="10" style="stroke:#181818;stroke-width:2.0;" width="776" x="2722" y="1026.5957"/><text fill="#000000" font-family="sans-serif" font-size="56" lengthAdjust="spacing" textLength="720" x="2750" y="1114.4512">Daemon event subscribers</text><polygon fill="#181818" points="1006,435.3379,1046,451.3379,1006,467.3379,1022,451.3379" style="stroke:#181818;stroke-width:4.0;"/><line style="stroke:#181818;stroke-width:4.0;" x1="354" x2="1030" y1="451.3379" y2="451.3379"/><text fill="#000000" font-family="sans-serif" font-size="52" lengthAdjust="spacing" textLength="332" x="382" y="428.1035">Incoming RPC</text><polygon fill="#181818" points="1414,562.1523,1454,578.1523,1414,594.1523,1430,578.1523" style="stroke:#181818;stroke-width:4.0;"/><line style="stroke:#181818;stroke-width:4.0;" x1="1054" x2="1438" y1="578.1523" y2="578.1523"/><text fill="#000000" font-family="sans-serif" font-size="52" lengthAdjust="spacing" textLength="312" x="1082" y="554.918">Save settings</text><polygon fill="#181818" points="398,688.9668,358,704.9668,398,720.9668,382,704.9668" style="stroke:#181818;stroke-width:4.0;"/><line style="stroke:#181818;stroke-width:4.0;" x1="374" x2="1050" y1="704.9668" y2="704.9668"/><text fill="#000000" font-family="sans-serif" font-size="52" lengthAdjust="spacing" textLength="604" x="422" y="681.7324">Return save result to RPC</text><polygon fill="#181818" points="3062,815.7813,3102,831.7813,3062,847.7813,3078,831.7813" style="stroke:#181818;stroke-width:4.0;"/><line style="stroke:#181818;stroke-width:4.0;" x1="1054" x2="3086" y1="831.7813" y2="831.7813"/><text fill="#000000" font-family="sans-serif" font-size="52" lengthAdjust="spacing" textLength="900" x="1082" y="808.5469">Publish new settings to all subscribers</text><polygon fill="#181818" points="2314,942.5957,2354,958.5957,2314,974.5957,2330,958.5957" style="stroke:#181818;stroke-width:4.0;"/><line style="stroke:#181818;stroke-width:4.0;" x1="1054" x2="2338" y1="958.5957" y2="958.5957"/><text fill="#000000" font-family="sans-serif" font-size="52" lengthAdjust="spacing" textLength="232" x="1082" y="935.3613">Send new</text><text fill="#000000" font-family="sans-serif" font-size="52" lengthAdjust="spacing" text-decoration="underline" textLength="208" x="1326" y="935.3613">allow lan</text><text fill="#000000" font-family="sans-serif" font-size="52" lengthAdjust="spacing" textLength="748" x="1546" y="935.3613">setting to TSM if it was changed</text><!--MD5=[0e1420f491e4dc6afb5ea3e4ba04175c]
@startuml
hide empty description
scale 800

title Execution of ""set_allow_lan"" RPC

participant "Management interface" as management_interface
participant "Daemon" as daemon
participant "Settings" as settings
participant "Tunnel state machine" as tsm
participant "Daemon event subscribers" as subscribers

management_interface -> daemon : Incoming RPC
daemon -> settings : Save settings
daemon -> management_interface : Return save result to RPC
daemon ->  subscribers : Publish new settings to all subscribers
daemon -> tsm : Send new __allow lan__ setting to TSM if it was changed


@enduml

PlantUML version 1.2022.3(Tue Mar 29 17:10:57 BST 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: GB
--></g></svg>